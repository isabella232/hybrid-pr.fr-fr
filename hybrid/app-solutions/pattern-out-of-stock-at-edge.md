---
title: Détection des ruptures de stock avec Azure et Azure Stack Edge
description: Découvrez comment utiliser les services Azure et Azure Stack Edge pour implémenter la détection des ruptures de stock.
author: BryanLa
ms.topic: article
ms.date: 11/05/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 11/05/2019
ms.openlocfilehash: 865f63bc4234e50ed169aa29cefdb1886750594c
ms.sourcegitcommit: bb3e40b210f86173568a47ba18c3cc50d4a40607
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/17/2020
ms.locfileid: "84910452"
---
# <a name="out-of-stock-detection-at-the-edge-pattern"></a><span data-ttu-id="3ff57-103">Détection des ruptures de stock en périphérie</span><span class="sxs-lookup"><span data-stu-id="3ff57-103">Out of stock detection at the edge pattern</span></span>

<span data-ttu-id="3ff57-104">Ce modèle explique comment déterminer les articles en rupture de stock à l'aide d'un appareil ou de caméras réseau Azure Stack Edge ou Azure IoT Edge.</span><span class="sxs-lookup"><span data-stu-id="3ff57-104">This pattern illustrates how to determine if shelves have out of stock items using an Azure Stack Edge or Azure IoT Edge device and network cameras.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="3ff57-105">Contexte et problème</span><span class="sxs-lookup"><span data-stu-id="3ff57-105">Context and problem</span></span>

<span data-ttu-id="3ff57-106">Les magasins physiques perdent des ventes quand leurs clients recherchent un article qui n’est pas en rayon.</span><span class="sxs-lookup"><span data-stu-id="3ff57-106">Physical retail stores lose sales because when customers look for an item, it's not present on the shelf.</span></span> <span data-ttu-id="3ff57-107">Alors que cet article est peut-être en réserve et n’a pas été remis en rayon.</span><span class="sxs-lookup"><span data-stu-id="3ff57-107">However, the item could have been in the back of the store and not been restocked.</span></span> <span data-ttu-id="3ff57-108">Les magasins entendent utiliser leur personnel plus efficacement et être systématiquement avertis quand des articles doivent être remis en rayon.</span><span class="sxs-lookup"><span data-stu-id="3ff57-108">Stores would like to use their staff more efficiently and get automatically notified when items need restocking.</span></span>

## <a name="solution"></a><span data-ttu-id="3ff57-109">Solution</span><span class="sxs-lookup"><span data-stu-id="3ff57-109">Solution</span></span>

<span data-ttu-id="3ff57-110">L’exemple de solution utilise un appareil périphérique, comme Azure Stack Edge dans chaque magasin, pour traiter efficacement les données des caméras des magasins.</span><span class="sxs-lookup"><span data-stu-id="3ff57-110">The solution example uses an edge device, like an Azure Stack Edge in each store, which efficiently processes data from cameras in the store.</span></span> <span data-ttu-id="3ff57-111">Cette conception optimisée permet aux magasins d’envoyer uniquement les événements et images pertinents dans le cloud.</span><span class="sxs-lookup"><span data-stu-id="3ff57-111">This optimized design lets stores send only relevant events and images to the cloud.</span></span> <span data-ttu-id="3ff57-112">Une telle conception économise la bande passante, l’espace de stockage et garantit la confidentialité des clients.</span><span class="sxs-lookup"><span data-stu-id="3ff57-112">The design saves bandwidth, storage space, and ensures customer privacy.</span></span> <span data-ttu-id="3ff57-113">Lorsqu'une image est lue à partir de chaque caméra, un modèle ML la traite et renvoie les zones en rupture de stock.</span><span class="sxs-lookup"><span data-stu-id="3ff57-113">As frames are read from each camera, an ML model processes the image and returns any out of stock areas.</span></span> <span data-ttu-id="3ff57-114">L’image et les zones en rupture de stock s’affichent sur une application web locale.</span><span class="sxs-lookup"><span data-stu-id="3ff57-114">The image and out of stock areas are displayed on a local web app.</span></span> <span data-ttu-id="3ff57-115">Ces données peuvent être envoyées vers un environnement Time Series Insight pour afficher des insights dans Power BI.</span><span class="sxs-lookup"><span data-stu-id="3ff57-115">This data can be sent to a Time Series Insight environment to show insights in Power BI.</span></span>

![Architecture de la solution de détection des ruptures de stock à la périphérie](media/pattern-out-of-stock-at-edge/solution-architecture.png)

<span data-ttu-id="3ff57-117">Le fonctionnement de la solution est le suivant :</span><span class="sxs-lookup"><span data-stu-id="3ff57-117">Here's how the solution works:</span></span>

1. <span data-ttu-id="3ff57-118">Les images sont capturées à partir d’une caméra réseau via HTTP ou RTSP.</span><span class="sxs-lookup"><span data-stu-id="3ff57-118">Images are captured from a network camera over HTTP or RTSP.</span></span>
2. <span data-ttu-id="3ff57-119">Les images sont redimensionnées et envoyées au pilote d’inférence, qui communique avec le modèle ML pour déterminer s’il existe des images de rupture de stock.</span><span class="sxs-lookup"><span data-stu-id="3ff57-119">The image is resized and sent to the inference driver, which communicates with the ML model to determine if there are any out of stock images.</span></span>
3. <span data-ttu-id="3ff57-120">Le modèle ML renvoie toutes les zones de rupture de stock.</span><span class="sxs-lookup"><span data-stu-id="3ff57-120">The ML model returns any out of stock areas.</span></span>
4. <span data-ttu-id="3ff57-121">Le pilote d’inférence charge l’image brute dans un objet blob (si spécifié) et envoie les résultats du modèle vers Azure IoT Hub et un processeur de cadre englobant sur l’appareil.</span><span class="sxs-lookup"><span data-stu-id="3ff57-121">The inferencing driver uploads the raw image to a blob (if specified), and sends the results from the model to Azure IoT Hub and a bounding box processor on the device.</span></span>
5. <span data-ttu-id="3ff57-122">Le processeur de cadre englobant ajoute des cadres englobants aux images et met en cache le chemin d’accès de ces images dans une base de données en mémoire.</span><span class="sxs-lookup"><span data-stu-id="3ff57-122">The bounding box processor adds bounding boxes to the image and caches the image path in an in-memory database.</span></span>
6. <span data-ttu-id="3ff57-123">L’application web interroge les images et les affiche dans l’ordre reçu.</span><span class="sxs-lookup"><span data-stu-id="3ff57-123">The web app queries for images and shows them in the order received.</span></span>
7. <span data-ttu-id="3ff57-124">Les messages d'IoT Hub sont agrégés dans Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="3ff57-124">Messages from IoT Hub are aggregated in Time Series Insights.</span></span>
8. <span data-ttu-id="3ff57-125">Power BI affiche un rapport interactif sur les éléments en rupture de stock avec les données issues de Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="3ff57-125">Power BI displays an interactive report of out of stock items over time with the data from Time Series Insights.</span></span>


## <a name="components"></a><span data-ttu-id="3ff57-126">Components</span><span class="sxs-lookup"><span data-stu-id="3ff57-126">Components</span></span>

<span data-ttu-id="3ff57-127">Cette solution utilise les composants suivants :</span><span class="sxs-lookup"><span data-stu-id="3ff57-127">This solution uses the following components:</span></span>

| <span data-ttu-id="3ff57-128">Couche</span><span class="sxs-lookup"><span data-stu-id="3ff57-128">Layer</span></span> | <span data-ttu-id="3ff57-129">Composant</span><span class="sxs-lookup"><span data-stu-id="3ff57-129">Component</span></span> | <span data-ttu-id="3ff57-130">Description</span><span class="sxs-lookup"><span data-stu-id="3ff57-130">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="3ff57-131">Matériel local</span><span class="sxs-lookup"><span data-stu-id="3ff57-131">On-premises hardware</span></span> | <span data-ttu-id="3ff57-132">Caméra réseau</span><span class="sxs-lookup"><span data-stu-id="3ff57-132">Network camera</span></span> | <span data-ttu-id="3ff57-133">Une caméra réseau avec flux HTTP ou RTSP est requise afin de fournir les images pour l’inférence.</span><span class="sxs-lookup"><span data-stu-id="3ff57-133">A network camera is required, with either an HTTP or RTSP feed to provide the images for inference.</span></span> |
| <span data-ttu-id="3ff57-134">Azure</span><span class="sxs-lookup"><span data-stu-id="3ff57-134">Azure</span></span> | <span data-ttu-id="3ff57-135">Azure IoT Hub</span><span class="sxs-lookup"><span data-stu-id="3ff57-135">Azure IoT Hub</span></span> | <span data-ttu-id="3ff57-136">[Azure IoT Hub](/azure/iot-hub/) gère le provisionnement des appareils et la messagerie pour les appareils périphériques.</span><span class="sxs-lookup"><span data-stu-id="3ff57-136">[Azure IoT Hub](/azure/iot-hub/) handles device provisioning and messaging for the edge devices.</span></span> |
|  | <span data-ttu-id="3ff57-137">Azure Time Series Insights</span><span class="sxs-lookup"><span data-stu-id="3ff57-137">Azure Time Series Insights</span></span> | <span data-ttu-id="3ff57-138">[Azure Time Series Insights](/azure/time-series-insights/) stocke les messages issus d'IoT Hub à des fins de visualisation.</span><span class="sxs-lookup"><span data-stu-id="3ff57-138">[Azure Time Series Insights](/azure/time-series-insights/) stores the messages from IoT Hub for visualization.</span></span> |
|  | <span data-ttu-id="3ff57-139">Power BI</span><span class="sxs-lookup"><span data-stu-id="3ff57-139">Power BI</span></span> | <span data-ttu-id="3ff57-140">[Microsoft Power BI](https://powerbi.microsoft.com/) fournit des rapports professionnels sur les événements de rupture de stock.</span><span class="sxs-lookup"><span data-stu-id="3ff57-140">[Microsoft Power BI](https://powerbi.microsoft.com/) provides business-focused reports of out of stock events.</span></span> <span data-ttu-id="3ff57-141">Power BI fournit une interface de tableau de bord conviviale pour visualiser les résultats issus d’Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="3ff57-141">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="3ff57-142">Appareil Azure Stack Edge ou</span><span class="sxs-lookup"><span data-stu-id="3ff57-142">Azure Stack Edge or</span></span><br><span data-ttu-id="3ff57-143">Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="3ff57-143">Azure IoT Edge device</span></span> | <span data-ttu-id="3ff57-144">Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="3ff57-144">Azure IoT Edge</span></span> | <span data-ttu-id="3ff57-145">[Azure IoT Edge](/azure/iot-edge/) orchestre le runtime des conteneurs locaux et gère les appareils, ainsi que les mises à jour.</span><span class="sxs-lookup"><span data-stu-id="3ff57-145">[Azure IoT Edge](/azure/iot-edge/) orchestrates the runtime for the on-premises containers and handles device management and updates.</span></span>|
| | <span data-ttu-id="3ff57-146">Project Brainwave Azure</span><span class="sxs-lookup"><span data-stu-id="3ff57-146">Azure project brainwave</span></span> | <span data-ttu-id="3ff57-147">Sur un appareil Azure Stack Edge, [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) utilise des FPGA (Field Programmable Gate Arrays) pour accélérer l’inférence ML.</span><span class="sxs-lookup"><span data-stu-id="3ff57-147">On an Azure Stack Edge device, [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) uses Field-Programmable Gate Arrays (FPGAs) to accelerate ML inferencing.</span></span>|

## <a name="issues-and-considerations"></a><span data-ttu-id="3ff57-148">Problèmes et considérations</span><span class="sxs-lookup"><span data-stu-id="3ff57-148">Issues and considerations</span></span>

<span data-ttu-id="3ff57-149">Prenez en compte des points suivants lors du choix de l'implémentation de cette solution :</span><span class="sxs-lookup"><span data-stu-id="3ff57-149">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="3ff57-150">Extensibilité</span><span class="sxs-lookup"><span data-stu-id="3ff57-150">Scalability</span></span>

<span data-ttu-id="3ff57-151">La plupart des modèles de Machine Learning s'exécutent uniquement à un certain nombre d’images par seconde, en fonction du matériel fourni.</span><span class="sxs-lookup"><span data-stu-id="3ff57-151">Most machine learning models can only run at a certain number of frames per second, depending on the provided hardware.</span></span> <span data-ttu-id="3ff57-152">Déterminez le taux d’échantillonnage optimal de vos caméras pour veiller à ce que le pipeline ML n’effectue pas de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="3ff57-152">Determine the optimal sample rate from your camera(s) to ensure that the ML pipeline doesn't back up.</span></span> <span data-ttu-id="3ff57-153">Différents types de matériel gèrent différents nombres de caméras et fréquences d’images.</span><span class="sxs-lookup"><span data-stu-id="3ff57-153">Different types of hardware will handle different numbers of cameras and frame rates.</span></span>

### <a name="availability"></a><span data-ttu-id="3ff57-154">Disponibilité</span><span class="sxs-lookup"><span data-stu-id="3ff57-154">Availability</span></span>

<span data-ttu-id="3ff57-155">Il est important d’anticiper ce qui peut se produire si l’appareil périphérique perd toute connectivité.</span><span class="sxs-lookup"><span data-stu-id="3ff57-155">It's important to consider what might happen if the edge device loses connectivity.</span></span> <span data-ttu-id="3ff57-156">Réfléchissez aux données susceptibles d'être perdues depuis le tableau de bord Time Series Insights et Power BI.</span><span class="sxs-lookup"><span data-stu-id="3ff57-156">Consider what data might be lost from the Time Series Insights and Power BI dashboard.</span></span> <span data-ttu-id="3ff57-157">L’exemple de solution fourni n'a pas vocation à être hautement disponible.</span><span class="sxs-lookup"><span data-stu-id="3ff57-157">The example solution as provided isn't designed to be highly available.</span></span>

### <a name="manageability"></a><span data-ttu-id="3ff57-158">Simplicité de gestion</span><span class="sxs-lookup"><span data-stu-id="3ff57-158">Manageability</span></span>

<span data-ttu-id="3ff57-159">Cette solution peut couvrir de nombreux appareils et emplacements, et donc devenir difficile à gérer.</span><span class="sxs-lookup"><span data-stu-id="3ff57-159">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="3ff57-160">Les services IoT d’Azure peuvent être utilisés pour mettre automatiquement en ligne de nouveaux emplacements et appareils et les maintenir à jour.</span><span class="sxs-lookup"><span data-stu-id="3ff57-160">Azure's IoT services can automatically bring new locations and devices online and keep them up to date.</span></span> <span data-ttu-id="3ff57-161">Des procédures de gouvernance des données appropriées doivent également être suivies.</span><span class="sxs-lookup"><span data-stu-id="3ff57-161">Proper data governance procedures must be followed as well.</span></span>

### <a name="security"></a><span data-ttu-id="3ff57-162">Sécurité</span><span class="sxs-lookup"><span data-stu-id="3ff57-162">Security</span></span>

<span data-ttu-id="3ff57-163">Ce modèle gère les données potentiellement sensibles.</span><span class="sxs-lookup"><span data-stu-id="3ff57-163">This pattern handles potentially sensitive data.</span></span> <span data-ttu-id="3ff57-164">Assurez-vous que les clés font régulièrement l’objet d’une rotation et que les autorisations relatives au compte de stockage Azure et aux partages locaux sont correctement définies.</span><span class="sxs-lookup"><span data-stu-id="3ff57-164">Make sure keys are regularly rotated and the permissions on the Azure Storage Account and local shares are correctly set.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3ff57-165">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="3ff57-165">Next steps</span></span>

<span data-ttu-id="3ff57-166">Pour en savoir plus sur les sujets abordés dans cet article :</span><span class="sxs-lookup"><span data-stu-id="3ff57-166">To learn more about topics introduced in this article:</span></span>
- <span data-ttu-id="3ff57-167">Plusieurs services IoT connexes sont utilisés dans ce modèle, notamment [Azure IoT Edge](/azure/iot-edge/), [Azure IoT Hub](/azure/iot-hub/) et [Azure Time Series Insights](/azure/time-series-insights/).</span><span class="sxs-lookup"><span data-stu-id="3ff57-167">Multiple IoT related services are used in this pattern, including [Azure IoT Edge](/azure/iot-edge/), [Azure IoT Hub](/azure/iot-hub/), and [Azure Time Series Insights](/azure/time-series-insights/).</span></span>
- <span data-ttu-id="3ff57-168">Pour en savoir plus sur Microsoft Project Brainwave, consultez [l’annonce du blog](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) ainsi que la [vidéo sur le Machine Learning accéléré par Azure avec Project Brainwave](https://www.youtube.com/watch?v=DJfMobMjCX0).</span><span class="sxs-lookup"><span data-stu-id="3ff57-168">To learn more about Microsoft Project Brainwave, see [the blog announcement](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) and checkout out the [Azure Accelerated Machine Learning with Project Brainwave video](https://www.youtube.com/watch?v=DJfMobMjCX0).</span></span>
- <span data-ttu-id="3ff57-169">Consultez [Considérations relatives à la conception des applications hybrides](overview-app-design-considerations.md) pour en savoir plus sur les bonnes pratiques et obtenir des réponses à d’autres questions.</span><span class="sxs-lookup"><span data-stu-id="3ff57-169">See [Hybrid app design considerations](overview-app-design-considerations.md) to learn more about best practices and to get answers to any additional questions.</span></span>
- <span data-ttu-id="3ff57-170">Consultez [Famille de produits et de solutions Azure Stack](/azure-stack) pour en savoir plus sur l’ensemble du portefeuille de produits et de solutions.</span><span class="sxs-lookup"><span data-stu-id="3ff57-170">See the [Azure Stack family of products and solutions](/azure-stack) to learn more about the entire portfolio of products and solutions.</span></span>

<span data-ttu-id="3ff57-171">Lorsque vous êtes prêt à tester l’exemple de solution, poursuivez avec le [Guide de déploiement de la solution Données hiérarchisées à des fins analytiques](https://aka.ms/edgeinferencingdeploy).</span><span class="sxs-lookup"><span data-stu-id="3ff57-171">When you're ready to test the solution example, continue with the [Tiered data for analytics solution deployment guide](https://aka.ms/edgeinferencingdeploy).</span></span> <span data-ttu-id="3ff57-172">Ce guide de déploiement fournit des instructions pas à pas sur le déploiement et sur le test de ses composants.</span><span class="sxs-lookup"><span data-stu-id="3ff57-172">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
